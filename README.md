# DanmakuRender —— 一个直播录制和弹幕渲染的小工具
结合网络上的代码写的一个直播录制和弹幕渲染的小工具，大概功能如下：      
- 录制直播流
- 录制直播弹幕
- 将弹幕渲染为AE项目
## 使用说明
### 前置要求
#### 录制
- Python 3.7+
- Python库 aiohttp,requests 
- FFmpeg
#### 弹幕渲染
- Windows平台
- Python 3.7+
- Adobe After Effects CC （建议使用Adobe After Effects CC2018及以上）
### 安装
- 下载源代码
- 将ffmpeg.exe移动到`tools`文件夹下 （如果不移动需要修改`config.json`里的ffmpeg路径）
### 简单使用
#### 录制
运行`main.py`，按要求输入URL，如果出现正在录制xxx的提示说明录制开始。   
录制的视频会存放在`save`文件夹中。
#### 渲染弹幕
运行`render.py`，按要求输入弹幕文件路径。  
此时将会直接打开AE程序，运行完成后AE会提示保存项目，选择保存路径即可。  
**注意：AE在项目保存后可能会自动关闭，尽量保证在AE未启动或者AE未打开任何项目时渲染弹幕**
### 详细说明
#### 录制选项
运行`main.py`时可以附带以下参数：
- `-u` 指定录制链接
- `-n` 指定录制的名称，默认为replay
- `-o` 指定输出文件夹，默认为此目录下的save文件夹
- `-s` 指定视频分块长度（单位：秒），默认为3600（一个小时一个文件）
- `-m` 监视此直播间，不需要参数。如果使用此参数则程序会一直监视直播间，并在开播时自动录制，直到用户主动关闭。如果不使用此参数则程序会在直播结束时结束。默认无此参数
- `--ffmpeg` 指定ffmpeg.exe文件路径
- `--record` 指定录制类型为以下三种：danmu（只录制弹幕），video（只录制视频），all（都录制），默认为all
#### 渲染选项
运行`render.py`时可以附带以下参数：
- `-f` 指定弹幕文件路径
- `-a` 指定AE的主程序AfterFX.exe所在路径，默认为auto，由程序自己搜索
- `--nosave` 指示AE不主动保存项目，也就是只渲染到AE的窗口，**如果AE此时存在项目，则会在当前项目新建一个合成并渲染，并不会创建新项目**     

关于录制和渲染的详细配置可以修改`config.json`文件。  
附带参数运行会覆盖在`config.json`文件里的设置。  
### 更多
如果有bug很正常，因为程序没有经过严格测试，只是一个简单的demo  
感谢 THMonster/danmaku, wbt5/real-url, ForgQi/biliup
